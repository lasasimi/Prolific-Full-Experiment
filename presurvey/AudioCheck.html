{{ block title }}
<link rel="stylesheet" href="{% static 'global/style.css' %}"/>
{{ endblock }}

{{ block content }}

<div class="card bg-mid m-0">
  <h2 class="card-header">üîä Check your audio</h2>
    <div class="card-body">
        <p>Please make sure your audio is on and the volume is up. You should hear a sound clip below. After listening to the clip, please select what you heard from the options below.</p>
        <p>Please click play to hear the number, then type it into the box below.</p>

        <audio id="checkAudio" src="{{ static 'test.mp3' }}" preload="auto"></audio>

        <div style="margin: 10px 0;">
            <button type="button" id="playBtn">‚ñ∂Ô∏è Play</button>
            <button type="button" id="pauseBtn">‚è∏Ô∏è Pause</button>
            <button type="button" id="stopBtn">‚èπÔ∏è Stop</button>
            <button type="button" id="volUpBtn">üîä Volume +</button>
            <button type="button" id="volDownBtn">üîâ Volume -</button>
        </div>
        <br>
        

    </div>
{% load static %}
<link rel="stylesheet" href="{{ static 'mp3player.css' }}" />
<script src="https://unpkg.com/wavesurfer.js@7/dist/plugins/regions.min.js"></script>
<script src="{{ static 'mp3player.js' }}"></script>
</head>
<body>


<div class="mp3-player">
<div id="waveform" aria-hidden="false"></div>


<div class="controls">
<button id="playPauseBtn" class="btn" aria-pressed="false">Play ‚ñ∂</button>
<button id="stopBtn" class="btn">Stop ‚èπ</button>
<button id="volDown" class="btn small">Vol -</button>
<div class="volume-display"> <span id="volumeVal">100%</span> </div>
<button id="volUp" class="btn small">Vol +</button>
</div>


<div style="display:flex;flex-direction:column;gap:6px;margin-left:8px;">
<div class="status" id="timeDisplay">00:00 / 00:00</div>
<div class="status" id="stateDisplay">State: Stopped</div>
</div>
</div>


<audio id="audioElement" preload="auto" crossorigin="anonymous"></audio>


<script>
// Pass mp3 url into JS
const MP3_URL = "{{ mp3_url }}";
</script>

</div>

        {{ formfield 'audio_answer' }}
<br>
<button class="next-button" type="submit">Next</button>

{{ endblock }}
{{ block scripts}}

<script>
const audio = document.getElementById('checkAudio');

document.getElementById('playBtn').addEventListener('click', async () => {
    try {
        await audio.play();
    } catch (e) {
        alert('Click play again to allow audio playback.');
    }
});

document.getElementById('pauseBtn').addEventListener('click', () => {
    audio.pause();
});

document.getElementById('stopBtn').addEventListener('click', () => {
    audio.pause();
    audio.currentTime = 0;
});

document.getElementById('volUpBtn').addEventListener('click', () => {
    audio.volume = Math.min(audio.volume + 0.1, 1);
});

document.getElementById('volDownBtn').addEventListener('click', () => {
    audio.volume = Math.max(audio.volume - 0.1, 0);
});
</script>
{{ endblock}}
{{ block style }}
<style>
.scale-container {
    display: flex;
    justify-content: space-between;
    margin: 10px 0;
    text-align: center;
}

.scale-option {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0px 5px 5px;
    white-space: normal;
}

.scale-number {
    font-weight: normal;
    font-size: normal;
    margin-bottom: 4px;
}

.scale-label {
    margin-top: 4px;
    font-size: 0.9em;
}
.playBtn {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: white;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}
stopBtn {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: white;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}
volUpBtn {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: white;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}
pauseBtn {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: white;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}
volDownBtn {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background: white;
  cursor: pointer;
  user-select: none;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}
</style>

{{ endblock}}

