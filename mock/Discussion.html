
{{ block title }}
<link rel="stylesheet" href="{% static 'global/style.css' %}"/>
What others are thinking
    
{{ endblock }}
{{ block content }}

{% if anticonformist %}
    <div class="nudge-anti-card">
        <h2>ðŸ’¡ Tip: Be the Agent of Change</h2>
            Some people might feel hesitant to express unpopular opinions. 
            To help reach the best decision, someone needs to voice a different 
            view to empower others to speak up.
            <br>
            ðŸ‘‰ <strong>That someone is you.</strong> Try not to conformâ€”challenge the norm and make space for overlooked ideas.
    </div>       
{% else %}
    <div class="nudge-confo-card">
        <h2>ðŸ’¡ Tip: Wisdom of Crowds</h2>
            Not sure what to choose? When the answer isnâ€™t obvious, itâ€™s helpful to see what others are doing.
            <br>
            ðŸ‘€ We are showing you your neighbors' choicesâ€”see if the majority points you in a clearer direction.
    </div>     

{% endif %}
<br>
<div class="card bg-mid m-0">
  <h4 class="card-header">{{ scenario_title }}</h4>

    <div class="card-body">
      {{ scenario_text }} 
      <br><br>
      <h5>Hereâ€™s what your small group of neighbors had to say:</h5>
      <br><br>
      <!-- Neighbors -->
      <div class="players-row neighbors">
        {{ for r in others_responses }}
        
          <div class="player">
             <!-- conditionally display the color of the speech bubble based on the response -->
                <div class="speech-bubble
                    {% if r == -1 %} bg-sage 
                    {% elif r == 0 %} bg-gray
                    {% else %} bg-lavender
                    {% endif %}">
                  {{ if r == -1 }}
                      {{ scenario_against }}
                  {{ elif r == 0 }}
                      {{ scenario_neutral }}
                  {{ else }}
                      {{ scenario_for }}
                  {{ endif }}
                </div>
            <img src="{{ static 'person-shape.png' }}" class="avatar">
          </div>
      {{ endfor }}

</div>
<br>
    <h5> <strong>What do you think the community should do?</strong></h5>
     
      <form method="post">
      {{ formfield_errors 'new_response' }}
        <input type="hidden" name="new_response" id="new_response">

        <div class="button-container">
          <button class="button button2 bg-sage" type="button" onclick="selectAnswer(this, '-1')">
              {{ scenario_against }}
          </button>
          <button class="button button2 bg-gray" type="button" onclick="selectAnswer(this, '0')">
              {{ scenario_neutral }}
          </button>
          <button class="button button2 bg-lavender" type="button" onclick="selectAnswer(this, '1')">
              {{ scenario_for }}
          </button>
        </div>
      </form>
    </div>
</div>

<br>
<br>

<script>
  function selectAnswer(button, value) {
      // Set the response value
      document.getElementById('new_response').value = value;

      // Style: mark selected
      const buttons = document.querySelectorAll('.button-container .button2');
      buttons.forEach(btn => btn.classList.remove('selected'));
      button.classList.add('selected');

      // Submit the form
      button.closest('form').submit();
  }
</script>

{{ endblock }}