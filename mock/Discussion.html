
{{ block title }}

What others are thinking
    
{{ endblock }}
{{ block content }}

<div class="card bg-mid m-0">
  <h4 class="card-header">{{ scenario_title }}</h4>

    <div class="card-body">
      {{ scenario_text }} 
      <br><br>
      <h5>Your group's answers</h5>
      You have been placed in a small discussion group with several of your neighbors to share ideas about what the community should do. Each neighbor in your group has shared their own opinion. Here’s what they said (including yours):
      <br><br>
      <!-- Neighbors -->
      <div class="players-row neighbors">
        {{ for r in others_responses }}
        
          <div class="player">
             <!-- conditionally display the color of the speech bubble based on the response -->
                <div class="speech-bubble
                    {% if r == -1 %} bg-sage 
                    {% elif r == 0 %} bg-gray
                    {% else %} bg-lavender
                    {% endif %}">
                  {{ if r == -1 }}
                      {{ scenario_against }}
                  {{ elif r == 0 }}
                      {{ scenario_neutral }}
                  {{ else }}
                      {{ scenario_for }}
                  {{ endif }}
                </div>
            <img src="{{ static 'person-shape.png' }}" class="avatar">
          </div>
      {{ endfor }}

</div>
<br>
      <strong>What do you think the community should do?</strong> 
      <br>
      <form method="post">
      {{ formfield_errors 'new_response' }}
        <input type="hidden" name="new_response" id="new_response">

        <div class="button-container">
          <button class="button button2 bg-sage" type="button" onclick="selectAnswer(this, '-1')">
              {{ scenario_against }}
          </button>
          <button class="button button2 bg-gray" type="button" onclick="selectAnswer(this, '0')">
              {{ scenario_neutral }}
          </button>
          <button class="button button2 bg-lavender" type="button" onclick="selectAnswer(this, '1')">
              {{ scenario_for }}
          </button>
        </div>
      </form>
    </div>
</div>

<br>
   
{{ if anticonformist }}
<div id="info-banner" style="background-color: #D9DDDC; color: black;" class="fixed bottom-0 left-0 right-0 p-4 flex justify-center items-center z-50">
    <h5>Tip: A Call for Independent Thinking</h5>
    <p class="text-lg font-semibold">
        Some people might not be comfortable speaking about their true opinion. 
        In order to arrive at the best decision possible, it's necessary for someone 
        to choose an opinion that is different from others to empower the minority 
        opinion to speak up. We have chosen you to do this task. Try not to conform and choose something that is different from the others. </p>

    <ul>
        <li>Sometimes the majority gets it wrong — trust your judgment.</li>
        <li>You don’t have to agree just because others do. Think for yourself.</li>
        <li>Being in the minority doesn’t mean you're wrong — it often means you're ahead.</li> 
    </ul>

</div>
    

{{  else }}
<div id="info-banner" style="background-color: #D9DDDC; color: black;" class="fixed bottom-0 left-0 right-0 p-4 flex justify-center items-center z-50">
    <h5>Tip: Reflections from Your Peers</h5>
    <p class="text-lg font-semibold">
        In a situation where it's not obvious which solution is the best, people often 
        look at others to help decide. Therefore, we will show you what others have chosen 
        in this scenario. You can look at their answers and see which one is the majority 
        to help guide your decision. </p>
    <ul>
        <li>Many others have already considered this carefully — you might find their reasoning helpful.</li>
        <li>This perspective has resonated with a lot of people in similar situations.</li>
        <li>Others have found this option to reflect shared values and priorities.</li> 
    </ul>
</div>
{{ endif }}

<br>


<script>
  function selectAnswer(button, value) {
      // Set the response value
      document.getElementById('new_response').value = value;

      // Style: mark selected
      const buttons = document.querySelectorAll('.button-container .button2');
      buttons.forEach(btn => btn.classList.remove('selected'));
      button.classList.add('selected');

      // Submit the form
      button.closest('form').submit();
  }
</script>

<style>
    .button {
        background-color: #3182bd;
        border: none;
        color: white;
        padding: 10px 24px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 18px;
        margin: 4px 2px;
        cursor: pointer;
        border-radius: 12px;
    }
    .button2 {
      background-color: white;
      color: black;
      border: 2px solid #008CBA;
      font-size: 16px;
    }
    .button2:hover {
      background-color: #008CBA;
      color: white;
    }
    .button2.selected {
        background-color: #005f8b; /* Darker blue for selected state */
        color: white;
        border: 2px solid #005f8b;
    }
    
    .button-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr); /* 3 equal-width columns, change 3 to 2 for 2 answer options */
      gap: 10px; /* Spacing between buttons */
      margin-top: 10px;
    }
    /* Media query for narrow devices */
    @media (max-width: 600px) {
        .button-container {
            grid-template-columns: 1fr; /* Switch to a single column layout */
            gap: 5px; /* Reduce spacing between buttons */
        }
    }    
    .button-container.button {
      text-align: center;
      padding: 10px 20px;
      font-size: 16px;
    }
    .next-button {
        background-color: white;
        color: black;
        border: 2px solid #008CBA;
        font-size: 16px;
        padding: 10px 24px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        cursor: pointer;
        border-radius: 12px;
    }
    .next-button:hover {
        background-color: #008CBA;
        color: white;
    }
    .next-button:active {
        background-color: #005f8b; /* Darker blue for clicked state */
        color: white;
        border: 2px solid #005f8b;
    }
    .matrix-table {
        width: 100%;
        table-layout: fixed;
        border-collapse: collapse;
    }

    table {
      width: 75%;
      padding: 10px;
      table-layout: fixed; /* Key: enforces equal column width */
      
    }
    th {
      padding: 10px;
      font-size: normal;
      text-align: left;
      word-wrap:normal; /* Prevents overflow in fixed layout */
      font-weight: normal; /* Ensures text is not bold */
    }
    th.scale-label { /* style for the likert label */
      width: 15%; /* Adjust this value as needed */
      text-align: center;
    }
    td {
      padding: 8px;
      text-align: center;
      word-wrap: break-word; /* Prevents overflow in fixed layout */
    }
    colgroup col:first-child {
      width: 60%; /* First column (question label) */
    }
    colgroup col:not(:first-child) {
      width: 10%; /* Evenly divide the rest (5 columns = 60% total) */
    }

/* To display the player avatars and speech bubbles */
.players-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
    margin-left: 10px;
    margin-right: 10px;
}

.players-row {
    display: flex;
    justify-content: center;
    gap: 20px;
}
.player {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    padding: 0.4rem 0.4rem;
}
.neighbors {
    padding: 0.2rem;
}

.avatar {
    width: 50px;
    height: 50px;
    background-color: #ccc;
    border-radius: 50%;
}

.speech-bubble {
    position: relative;
    border-radius: 0.5rem;
    padding: 0.4rem 0.8rem;
    margin-bottom: 10px;
    text-align: center;
    min-width: 120px;
}

.speech-bubble:after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    border-width: 10px 10px 0 10px;
    border-style: solid;
}

/* Speech bubble background classes */
.bg-sage {
    background-color: #c7dbb2;
}
.bg-gray {
    background-color: #e4e9eb;
}
.bg-lavender {
    background-color: #c8b6e3;
}

/* Matching triangle tips */
.bg-sage::after {
    border-color: #c7dbb2 transparent transparent transparent;
}
.bg-gray::after {
    border-color: #e4e9eb transparent transparent transparent;
}
.bg-lavender::after {
    border-color: #c8b6e3 transparent transparent transparent;
}
    </style>
{{ endblock }}